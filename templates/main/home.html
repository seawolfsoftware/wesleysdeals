{% extends 'main/base.html' %}

{% block head %}
    <title>Home</title>

    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/home.css' %}">
{% endblock %}


{% block body %}


        <h1 id="headline">Latest Deals & Steals!</h1>


        <div id="posts-container" class="container">

            {% for post in posts %}

            <div id="post-row" class="row">



                <div class="post block col-sm">

                    <a href="{% url 'PostDetail' post.pk %}">
                        <h2 id="post_title" class="subtitle">{{ post.title }}</h2>
                    </a>

                    <div id="created_at" class="row justify-content-center">
                        <div class="col-4">
                            <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js">
                                </script>
                                <lottie-player id="hr-lottie"
                                                src="https://assets6.lottiefiles.com/packages/lf20_mcgv3at1.json"
                                               background="transparent"
                                               speed="1"
                                                style="height: 35px"
                                               loop
                                               autoplay>
                                </lottie-player>
                        </div>
                        <div class="col-8" id="created_at_text">
                            Posted at  {{ post.created_at}}
                        </div>


                    </div>

                    <img id="product-image" src="{{ post.image.url}}"  alt="{{ post.title }}">

                    <p id="post_body"> {{ post.body }}</p>

                    <button id="code" type="button" class="btn btn-outline-success">
                        <div class="visible">
                            {% if user.is_authenticated %}
                                <div id ="holding-cell{{post.id}}">
                                        Click to Reveal Code!
                                </div>
                                <script>
                               $(function (){
                                    $('#holding-cell{{post.id}}').on('click', function(){

                                        $('#holding-cell{{post.id}}').html('XYZ123ZZZ');
                                    });
                                });
                                </script>
                            {% else %}

                            <a id="register-for-code" href="{% url 'register' %}">
                                Register for Code

                                <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js">
                                </script>
                                <lottie-player id="hr-lottie"
                                                src="https://assets5.lottiefiles.com/packages/lf20_NzYmoW.json"
                                               background="transparent"
                                               speed="2"
                                                style="height: 75px"
                                               loop
                                               autoplay>
                                </lottie-player>
                            </a>


                            {% endif %}
                        </div>
                    </button>
                </div>

            </div>

            <hr class="hr">
            {% endfor %}
        </div>




{% endblock %}